<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>El Penjat dels Planetes</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800;900&display=swap');

    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #e0f2fe 0%, #f1f5f9 100%);
      min-height: 100vh;
      color: #1e293b;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0;
      overflow-x: hidden;
    }

    .floating-planet {
      position: absolute;
      z-index: 0;
      opacity: 0.15;
      animation: float var(--duration) infinite ease-in-out;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(5deg); }
    }

    .hangman-part {
      stroke: #334155;
      stroke-width: 4;
      fill: none;
      stroke-linecap: round;
      transition: opacity 0.3s ease;
    }

    .letter-slot {
      border-bottom: 3px solid #0ea5e9;
      width: 2.5rem;
      height: 3rem;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      font-weight: 800;
      margin: 0 0.25rem;
      text-transform: uppercase;
      color: #0f172a;
      user-select: none;
    }

    .key-button {
      transition: all 0.2s ease;
      box-shadow: 0 2px 0 #94a3b8;
      user-select: none;
    }

    .key-button:active:not(:disabled) {
      transform: translateY(2px);
      box-shadow: 0 0 0 #94a3b8;
    }

    .planet-preview {
      filter: drop-shadow(0 10px 15px rgba(0,0,0,0.1));
      transition: all 0.5s ease;
    }

    .modal-overlay {
      background: rgba(15, 23, 42, 0.4);
      backdrop-filter: blur(8px);
    }
  </style>
</head>
<body>
  <!-- Fons decoratiu -->
  <div id="bg-decor" class="fixed inset-0 pointer-events-none"></div>

  <div class="max-w-3xl w-full mx-auto p-6 relative z-10">
    <header class="text-center mb-6">
      <h1 class="text-4xl font-extrabold text-sky-600 mb-1 tracking-tight">EL PENJAT</h1>
      <p class="text-slate-500 font-medium uppercase tracking-widest text-xs">Explorant el Sistema Solar</p>
    </header>

    <div class="bg-white/80 backdrop-blur-md p-8 rounded-[2.5rem] shadow-xl border border-white/50">
      <div class="flex flex-col lg:flex-row items-center justify-between gap-10">

        <!-- Panell Visual -->
        <div class="flex flex-col items-center gap-4">
          <!-- Visual del penjat -->
          <div class="w-44 h-56 bg-sky-50 rounded-3xl p-4 flex items-center justify-center border border-sky-100 shadow-inner">
            <svg viewBox="0 0 100 120" class="w-full h-full" aria-label="Penjat">
              <line x1="10" y1="110" x2="50" y2="110" stroke="#94a3b8" stroke-width="4" />
              <line x1="30" y1="110" x2="30" y2="10" stroke="#94a3b8" stroke-width="4" />
              <line x1="30" y1="10" x2="70" y2="10" stroke="#94a3b8" stroke-width="4" />
              <line x1="70" y1="10" x2="70" y2="30" stroke="#94a3b8" stroke-width="4" />

              <circle id="part-0" class="hangman-part opacity-0" cx="70" cy="40" r="10" />
              <line id="part-1" class="hangman-part opacity-0" x1="70" y1="50" x2="70" y2="80" />
              <line id="part-2" class="hangman-part opacity-0" x1="70" y1="60" x2="55" y2="70" />
              <line id="part-3" class="hangman-part opacity-0" x1="70" y1="60" x2="85" y2="70" />
              <line id="part-4" class="hangman-part opacity-0" x1="70" y1="80" x2="55" y2="95" />
              <line id="part-5" class="hangman-part opacity-0" x1="70" y1="80" x2="85" y2="95" />
            </svg>
          </div>

          <!-- Imatge del Planeta (recompensa/pista) -->
          <div id="planet-icon-container" class="w-24 h-24 flex items-center justify-center opacity-40 grayscale hover:grayscale-0 hover:opacity-100 transition-all duration-700">
            <!-- L'icona del planeta es carregarÃ  aquÃ­ -->
          </div>
        </div>

        <!-- Joc i Paraula -->
        <div class="flex-1 flex flex-col items-center w-full">
          <div id="word-display" class="flex flex-wrap justify-center mb-8" aria-live="polite"></div>

          <div class="bg-sky-100/50 px-6 py-2 rounded-full mb-6 border border-sky-200">
            <span class="text-slate-500 text-sm font-bold uppercase tracking-wide mr-2">Vides:</span>
            <span id="lives-count" class="text-sky-600 font-black text-2xl">6</span>
          </div>

          <button id="hint-btn" class="text-xs font-bold uppercase tracking-widest text-sky-600 hover:bg-sky-100 px-6 py-2 rounded-full border border-sky-200 transition-all mb-4">
            ðŸ’¡ Necessites una pista?
          </button>
          <div id="hint-display" class="text-center text-sm text-slate-500 italic px-4"></div>

          <div id="status" class="mt-4 text-center text-sm font-semibold text-slate-600" aria-live="polite"></div>
        </div>
      </div>

      <!-- Teclat -->
      <div id="keyboard" class="grid grid-cols-7 sm:grid-cols-9 gap-3 mt-10" aria-label="Teclat"></div>
    </div>

    <div class="mt-8 text-center">
      <button id="reset-btn" class="bg-white hover:bg-slate-50 text-slate-600 px-10 py-3 rounded-2xl font-bold transition-all shadow-md border border-slate-200 uppercase tracking-widest text-xs">
        Canviar de Planeta
      </button>
    </div>
  </div>

  <!-- Modal Final -->
  <div id="game-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden p-4" role="dialog" aria-modal="true">
    <div class="modal-overlay absolute inset-0"></div>
    <div class="bg-white p-10 rounded-[3rem] relative z-10 max-w-sm w-full text-center shadow-2xl border border-slate-100">
      <div id="modal-icon" class="text-6xl mb-4">ðŸš€</div>
      <h2 id="modal-title" class="text-4xl font-black mb-2 text-slate-800 tracking-tight">HAS GUANYAT!</h2>
      <p class="text-slate-500 mb-8">La resposta correcta era: <br><span id="correct-word" class="font-black text-sky-600 text-2xl uppercase">PLANETA</span></p>
      <button id="play-again" class="w-full bg-sky-500 hover:bg-sky-600 text-white font-black py-4 rounded-2xl transition-all shadow-lg shadow-sky-200">
        JUGAR DE NOU
      </button>
    </div>
  </div>

  <script>
    // ================================
    // El Penjat dels Planetes (CA)
    // - Estil Tailwind + CSS com el model
    // - Click events (teclat a botons)
    // - Accepta lletres sense accent per encertar lletres amb accent
    // ================================

    const MAX_MISTAKES = 6;

    // Normalitza (treu accents) i passa a majÃºscules
    function normalize(s){
      return s
        .normalize('NFD')
        .replace(/[Ì€-Í¯]/g, '')
        .toUpperCase();
    }

    // SVG planeta simple
    const getPlanetSVG = (color, hasRings = false) => `
      <svg viewBox="0 0 100 100" class="w-full h-full planet-preview" aria-hidden="true">
        ${hasRings ? `<ellipse cx="50" cy="50" rx="45" ry="15" fill="none" stroke="#cbd5e1" stroke-width="4" transform="rotate(-20 50 50)" />` : ''}
        <circle cx="50" cy="50" r="35" fill="${color}" />
        <circle cx="40" cy="40" r="10" fill="white" opacity="0.2" />
        ${hasRings ? `<ellipse cx="50" cy="50" rx="45" ry="15" fill="none" stroke="#94a3b8" stroke-width="2" transform="rotate(-20 50 50)" stroke-dasharray="10 5" />` : ''}
      </svg>
    `;

    // Dades (display amb accents, i pista)
    const PLANETS = [
      { display: "Mercuri", color: "#94a3b8", rings: false, hint: "Ã‰s el planeta mÃ©s petit i el mÃ©s proper al Sol." },
      { display: "Venus",   color: "#fbbf24", rings: false, hint: "Ã‰s el planeta mÃ©s calent i brilla molt al cel." },
      { display: "Terra",   color: "#3b82f6", rings: false, hint: "L'Ãºnic planeta conegut que tÃ© vida i molta aigua." },
      { display: "Mart",    color: "#ef4444", rings: false, hint: "Se'l coneix com el â€œplaneta vermellâ€." },
      { display: "JÃºpiter", color: "#a8a29e", rings: false, hint: "Ã‰s el gegant del Sistema Solar: el planeta mÃ©s gran." },
      { display: "Saturn",  color: "#fde047", rings: true,  hint: "Ã‰s famÃ³s pels seus espectaculars anells." },
      { display: "UrÃ ",     color: "#22d3ee", rings: false, hint: "Un gegant de gel que gira gairebÃ© de costat." },
      { display: "NeptÃº",   color: "#1d4ed8", rings: false, hint: "Ã‰s el planeta mÃ©s llunyÃ  del Sol i Ã©s d'un blau intens." }
    ].map(p => ({ ...p, norm: normalize(p.display) }));

    const ALPHABET = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");

    // Elements UI
    const bgDecor = document.getElementById('bg-decor');
    const wordDisplay = document.getElementById('word-display');
    const livesCount = document.getElementById('lives-count');
    const keyboard = document.getElementById('keyboard');
    const planetIconContainer = document.getElementById('planet-icon-container');
    const hintBtn = document.getElementById('hint-btn');
    const hintDisplay = document.getElementById('hint-display');
    const resetBtn = document.getElementById('reset-btn');
    const statusEl = document.getElementById('status');

    const modal = document.getElementById('game-modal');
    const modalTitle = document.getElementById('modal-title');
    const modalIcon = document.getElementById('modal-icon');
    const correctWord = document.getElementById('correct-word');
    const playAgain = document.getElementById('play-again');

    // Estat
    let selected = null;
    let guessed = new Set(); // lletres A-Z
    let mistakes = 0;
    let over = false;

    function setStatus(text){
      statusEl.textContent = text || "";
    }

    function createBackground(){
      bgDecor.innerHTML = "";
      const colors = ["#cbd5e1", "#bae6fd", "#fed7aa", "#fecaca"]; 
      for (let i = 0; i < 8; i++){
        const div = document.createElement('div');
        div.className = 'floating-planet';
        const size = 40 + Math.random() * 100;
        div.style.width = `${size}px`;
        div.style.height = `${size}px`;
        div.style.left = `${Math.random() * 90}%`;
        div.style.top = `${Math.random() * 90}%`;
        div.style.setProperty('--duration', `${5 + Math.random() * 10}s`);
        div.innerHTML = getPlanetSVG(colors[i % colors.length], Math.random() > 0.7);
        bgDecor.appendChild(div);
      }
    }

    function initKeyboard(){
      keyboard.innerHTML = "";
      for (const L of ALPHABET){
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.innerText = L;
        btn.id = `key-${L}`;
        btn.className = "key-button bg-white text-slate-700 font-bold py-3 rounded-xl border border-slate-200 hover:bg-sky-50 hover:border-sky-300";
        btn.addEventListener('click', () => guess(L));
        keyboard.appendChild(btn);
      }
    }

    function updateHangman(){
      for (let i = 0; i < MAX_MISTAKES; i++){
        const part = document.getElementById(`part-${i}`);
        if (!part) continue;
        if (i < mistakes) part.classList.remove('opacity-0');
        else part.classList.add('opacity-0');
      }
    }

    function updatePlanetPreview(){
      // ProgrÃ©s: quantes lletres Ãºniques de la paraula s'han endevinat
      const letters = selected.norm.replace(/[^A-Z]/g, "");
      const uniq = new Set(letters.split(""));
      let hit = 0;
      for (const c of uniq){ if (guessed.has(c)) hit++; }
      const progress = uniq.size ? (hit / uniq.size) : 0;

      planetIconContainer.style.filter = `grayscale(${100 - (progress * 100)}%)`;
      planetIconContainer.style.opacity = (0.3 + (progress * 0.7)).toFixed(2);
    }

    function updateWord(){
      wordDisplay.innerHTML = "";
      const chars = Array.from(selected.display.toUpperCase());
      const normChars = Array.from(selected.norm);

      chars.forEach((ch, i) => {
        const slot = document.createElement('div');
        slot.className = 'letter-slot';

        const n = normChars[i];
        if (/[A-Z]/.test(n)){
          slot.innerText = guessed.has(n) ? ch : "";
        } else {
          // si algun dia hi ha espais/guions
          slot.innerText = ch;
          slot.style.borderBottom = '0';
          slot.style.width = '1rem';
        }

        wordDisplay.appendChild(slot);
      });
    }

    function updateLives(){
      livesCount.innerText = String(MAX_MISTAKES - mistakes);
    }

    function updateKeyboard(){
      for (const btn of keyboard.querySelectorAll('button')){
        const L = btn.innerText;
        const used = guessed.has(L);
        btn.disabled = over || used;
      }
    }

    function updateUI(){
      updateWord();
      updateLives();
      updateHangman();
      updatePlanetPreview();
      updateKeyboard();
    }

    function showHint(){
      hintDisplay.innerText = selected.hint;
      hintBtn.classList.add('hidden');
    }

    function isWin(){
      // totes les lletres (A-Z) de la paraula han d'estar endevinades
      for (const c of selected.norm){
        if (/[A-Z]/.test(c) && !guessed.has(c)) return false;
      }
      return true;
    }

    function endGame(won){
      over = true;

      modal.classList.remove('hidden');
      correctWord.innerText = selected.display.toUpperCase();

      if (won){
        modalTitle.innerText = "HAS GUANYAT!";
        modalTitle.className = "text-4xl font-black mb-2 text-sky-600";
        modalIcon.innerText = "ðŸŒŸ";
        setStatus("âœ… Correcte!");
      } else {
        modalTitle.innerText = "HAS PERDUT!";
        modalTitle.className = "text-4xl font-black mb-2 text-red-500";
        modalIcon.innerText = "ðŸ›¸";
        setStatus("âŒ Has esgotat les vides.");

        // Revela la paraula al tauler
        for (const c of selected.norm){
          if (/[A-Z]/.test(c)) guessed.add(c);
        }
      }

      updateUI();
    }

    function markKey(letter, ok){
      const btn = document.getElementById(`key-${letter}`);
      if (!btn) return;
      if (ok){
        btn.classList.add('!bg-sky-500', '!text-white', '!border-sky-600');
      } else {
        btn.classList.add('!bg-slate-200', '!text-slate-400', '!border-slate-300');
      }
    }

    function guess(letter){
      if (over) return;
      if (!/^[A-Z]$/.test(letter)) return;
      if (guessed.has(letter)) return;

      guessed.add(letter);
      const ok = selected.norm.includes(letter);

      markKey(letter, ok);

      if (!ok){
        mistakes++;
        setStatus(`No hi Ã©s: ${letter}`);
        if (mistakes >= MAX_MISTAKES) return endGame(false);
      } else {
        setStatus(`BÃ©! Hi ha la lletra: ${letter}`);
        if (isWin()) return endGame(true);
      }

      updateUI();
    }

    function resetGame(){
      selected = PLANETS[Math.floor(Math.random() * PLANETS.length)];
      guessed = new Set();
      mistakes = 0;
      over = false;

      planetIconContainer.innerHTML = getPlanetSVG(selected.color, selected.rings);
      hintDisplay.innerText = "";
      hintBtn.classList.remove('hidden');
      modal.classList.add('hidden');

      initKeyboard();
      setStatus("Endevina el planeta!");
      updateUI();
    }

    // Esdeveniments
    hintBtn.addEventListener('click', showHint);
    resetBtn.addEventListener('click', resetGame);
    playAgain.addEventListener('click', resetGame);

    // Teclat fÃ­sic (opcional)
    window.addEventListener('keydown', (ev) => {
      const key = ev.key;
      if (!key || key.length !== 1) return;
      const L = normalize(key).replace(/[^A-Z]/g, "");
      if (L.length === 1) guess(L);
    });

    // Init
    window.onload = () => {
      createBackground();
      resetGame();
    };
  </script>
</body>
</html>
