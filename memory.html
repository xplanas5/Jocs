<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Memory de Sumes</title>
  <link rel="icon" href="favicon.svg" type="image/svg+xml">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    *,*::before,*::after{ box-sizing:border-box; }
    html,body,#root{ height:100%; width:100%; margin:0; }
    body{ min-height:100vh; min-width:100vw; overflow-x:hidden; overflow-y:auto; }
    #root{ display:flex; min-height:100vh; min-width:100vw; }
    .app-container{ flex:1 0 auto; min-height:100vh; width:100%; }
    @supports (height: 100dvh){
      body, #root, .app-container{ min-height:100dvh; }
    }
    /* Flip 3D per a les cartes */
    .card-3d{ perspective:1000px; }
    .card-inner{
      position:relative; transform-style:preserve-3d;
      transition: transform .45s ease;
    }
    .card-face{
      backface-visibility:hidden; -webkit-backface-visibility:hidden;
      position:absolute; inset:0;
    }
    .card-front{ transform: rotateY(180deg); } /* CONTINGUT OCULT AL INICI */
    .card-back{ transform: rotateY(0deg); }    /* "?" VISIBLE */
    .revealed .card-inner{ transform: rotateY(180deg); } /* MOSTRA CONTINGUT, OCULTA "?" */
    /* Feedback d'error breu */
    .shake { animation: shake .28s ease; }
    @keyframes shake{
      0%{ transform:translateX(0) }
      25%{ transform:translateX(-6px) }
      50%{ transform:translateX(6px) }
      75%{ transform:translateX(-4px) }
      100%{ transform:translateX(0) }
    }
    /* Fade-in suau d'elements */
    @keyframes fadeInUp{
      from{ opacity:0; transform:translateY(10px) }
      to{ opacity:1; transform:translateY(0) }
    }
    .fadeInUp{ animation: fadeInUp .4s ease-out both; }
  </style>
</head>
<body class="transition-colors duration-300 bg-gradient-to-br from-purple-100 via-pink-100 to-blue-100 text-slate-800 dark:from-slate-950 dark:via-slate-900 dark:to-slate-900 dark:text-slate-100">
  <div id="root" class="app-container flex flex-col">
    <!-- Header -->
    <header class="w-full sticky top-0 z-10 backdrop-blur supports-[backdrop-filter]:bg-white/50 dark:supports-[backdrop-filter]:bg-slate-900/40 bg-white/70 dark:bg-slate-900/60 border-b border-white/30 dark:border-slate-700/50">
      <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
        <h1 class="text-3xl md:text-4xl font-black bg-gradient-to-r from-purple-600 via-pink-600 to-blue-600 bg-clip-text text-transparent">
          üß†‚ûï Memory de Sumes
        </h1>
        <button id="toggleDark"
          class="rounded-full px-4 py-2 text-sm font-semibold shadow-lg shadow-black/5 border border-black/5 dark:border-white/10
                 bg-slate-900 text-amber-300 dark:bg-amber-300 dark:text-slate-900 hover:scale-105 transition">
          <span class="inline dark:hidden">üåô Mode fosc</span>
          <span class="hidden dark:inline">‚òÄÔ∏è Mode clar</span>
        </button>
      </div>
    </header>

    <!-- Controls -->
    <div class="max-w-7xl mx-auto w-full px-4 py-6">
      <div class="grid gap-4 md:grid-cols-[1fr_auto_auto_auto] items-end">
        <div class="rounded-2xl p-4 bg-white/70 dark:bg-slate-800/60 border border-black/5 dark:border-white/10 shadow-sm">
          <label class="block text-xs uppercase tracking-wide opacity-70 mb-1">Descripci√≥</label>
          <p class="text-sm opacity-90">Torna les parelles <strong>Operaci√≥ ‚Üî Resultat</strong>. Pots triar el nombre de caselles i el resultat m√†xim.</p>
        </div>

        <div class="rounded-2xl p-4 bg-white/70 dark:bg-slate-800/60 border border-black/5 dark:border-white/10 shadow-sm">
          <label for="tiles" class="block text-xs uppercase tracking-wide opacity-70 mb-1">Caselles</label>
          <select id="tiles"
                  class="w-full rounded-xl px-3 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700">
            <option value="10">10 (5 parelles)</option>
            <option value="16" selected>16 (8 parelles)</option>
            <option value="22">22 (11 parelles)</option>
          </select>
        </div>

        <div class="rounded-2xl p-4 bg-white/70 dark:bg-slate-800/60 border border-black/5 dark:border-white/10 shadow-sm">
          <label for="maxRes" class="block text-xs uppercase tracking-wide opacity-70 mb-1">Resultat m√†xim</label>
          <input id="maxRes" type="number" min="4" value="20"
                 class="w-36 rounded-xl px-3 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700" />
          <p class="text-xs mt-1 opacity-70">Per 22 caselles recomanat ‚â• 12</p>
        </div>

        <div class="flex gap-2">
          <button id="new"
                  class="rounded-xl px-4 py-3 text-sm font-semibold shadow-lg shadow-emerald-500/20
                         bg-gradient-to-r from-emerald-400 to-emerald-600 text-white hover:shadow-emerald-500/30 hover:scale-[1.02] transition">
            Nova partida
          </button>
          <button id="reset"
                  class="rounded-xl px-4 py-3 text-sm font-semibold shadow-lg shadow-slate-900/10
                         bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 hover:scale-[1.02] transition">
            Reinicia
          </button>
        </div>
      </div>

      <!-- Stats -->
      <div class="mt-4 flex flex-wrap gap-3">
        <div class="rounded-xl px-4 py-2 bg-white/70 dark:bg-slate-800/60 border border-black/5 dark:border-white/10">
          ‚è±Ô∏è <span class="font-bold" id="time">00:00</sp
